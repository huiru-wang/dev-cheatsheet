
# 文件查询

## 查询行数
```shell
# 文件行数
wc -l [filename]

# 过滤后行数
grep [keyword] [filename] | -wc
```

## 显示指定行前后n行
```shell
grep [keyword] [filename] -A n  # 后n行
grep [keyword] [filename] -B n  # 前n行
grep [keyword] [filename] -C n  # 前后n行
```

## 查询结果显示行号
```shell
grep [keyword] [filename] -n
cat [filename] -n
more [filename] | grep 'data' -n
```

## 多文件查询

### 指定多个文件查询
```shell
grep [keyword] [filename] [filename] [filename] ... -n
```

### 正则匹配多文件
```shell
grep -r [keyword] *.log -n
```

### 路径查询
```shell
grep -r [keyword] /etc/
grep -r [keyword] .
```

## 模式匹配
### 忽略大小写
```shell
grep -i 'data' [filename]
```

### 单词完整匹配
```shell
grep -w 'data' [filename]
```

### 模式匹配
```shell
grep -E 'data' [filename]
# 或
grep -E 'data' -E 'mail' [filename]
grep -E 'data|mail' [filename]
```

### 时间范围查询
```shel
grep '2022-08-06 11:3[4-7]' run.log
```

## awk切分日志
### 切分后输出指定列
```shell
grep 'keyword' access.log | awk -F '|' '{print $1"|"$5}'
```

### 切分后过滤

```shell
tail -f access.log | awk -F '|' '{ if($5 ~ "keyword1" || $5 ~ "keyword") print $1"|"$5}'
tail -f access.log | awk -F '|' '{ if($5 ~ "(keyword1|keyword2)") print $1"|"$5}'
```

### 时间过滤
```shell
grep 'keyword' access.log | awk -F '|' '{if($1 > "2022-09-04 11:46:05") print $1"|"$5}'
```



