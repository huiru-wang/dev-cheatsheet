import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.fd95ed2e.js";const d=JSON.parse('{"title":"MySQL窗口函数","description":"","frontmatter":{},"headers":[],"relativePath":"MySQL/窗口函数.md","filePath":"MySQL/窗口函数.md"}'),p={name:"MySQL/窗口函数.md"},o=l(`<h1 id="mysql窗口函数" tabindex="-1">MySQL窗口函数 <a class="header-anchor" href="#mysql窗口函数" aria-label="Permalink to &quot;MySQL窗口函数&quot;">​</a></h1><h2 id="排序函数" tabindex="-1">排序函数 <a class="header-anchor" href="#排序函数" aria-label="Permalink to &quot;排序函数&quot;">​</a></h2><p>三种排序函数使用方法一样：</p><ul><li>按照<code>column1</code>分组;</li><li>组内按照<code>column2</code>排序</li><li>每组内进行排序，并返回名次作为rank</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">rank</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">partition</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> [column1] </span><span style="color:#F97583;">order by</span><span style="color:#E1E4E8;"> [column2]) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`rank\`</span></span>
<span class="line"><span style="color:#79B8FF;">dense_rank</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">partition</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> [column1] </span><span style="color:#F97583;">order by</span><span style="color:#E1E4E8;"> [column2]) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`rank\`</span></span>
<span class="line"><span style="color:#79B8FF;">row_number</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">partition</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> [column1] </span><span style="color:#F97583;">order by</span><span style="color:#E1E4E8;"> [column2]) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`rank\`</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">rank</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">partition</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> [column1] </span><span style="color:#D73A49;">order by</span><span style="color:#24292E;"> [column2]) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`rank\`</span></span>
<span class="line"><span style="color:#005CC5;">dense_rank</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">partition</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> [column1] </span><span style="color:#D73A49;">order by</span><span style="color:#24292E;"> [column2]) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`rank\`</span></span>
<span class="line"><span style="color:#005CC5;">row_number</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">partition</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> [column1] </span><span style="color:#D73A49;">order by</span><span style="color:#24292E;"> [column2]) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`rank\`</span></span></code></pre></div><p>只是相同时的策略不同，以如下数据集为例：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- Report Table Items</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+</span></span>
<span class="line"><span style="color:#E1E4E8;">| id | score | course  |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">  | English |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | Math    |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">85</span><span style="color:#E1E4E8;">  | English |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | English |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- Report Table Items</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+</span></span>
<span class="line"><span style="color:#24292E;">| id | score | course  |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">  | English |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | Math    |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">85</span><span style="color:#24292E;">  | English |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | English |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+</span></span></code></pre></div><h3 id="rank" tabindex="-1">rank() <a class="header-anchor" href="#rank" aria-label="Permalink to &quot;rank()&quot;">​</a></h3><p><strong>相同则并列，后续按数量：1，1，3</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">rank</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">partition</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> course </span><span style="color:#F97583;">order by</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">DESC</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`rank\`</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> Report;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">| id | score | course  | rank |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">85</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">rank</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">partition</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> course </span><span style="color:#D73A49;">order by</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">DESC</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`rank\`</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> Report;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#24292E;">| id | score | course  | rank |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">85</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span></code></pre></div><h3 id="dense-rank" tabindex="-1">dense_rank() <a class="header-anchor" href="#dense-rank" aria-label="Permalink to &quot;dense_rank()&quot;">​</a></h3><p><strong>相同则并列，后续按名词：1，1，2</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">dense_rank</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">partition</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> course </span><span style="color:#F97583;">order by</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">DESC</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`rank\`</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> Report;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">| id | score | course  | rank |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">85</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">dense_rank</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">partition</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> course </span><span style="color:#D73A49;">order by</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">DESC</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`rank\`</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> Report;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#24292E;">| id | score | course  | rank |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">85</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span></code></pre></div><h3 id="row-number" tabindex="-1">row_number() <a class="header-anchor" href="#row-number" aria-label="Permalink to &quot;row_number()&quot;">​</a></h3><p><strong>不存在并列</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">row_number</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">partition</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> course </span><span style="color:#F97583;">order by</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">DESC</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`rank\`</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> Scores;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">| id | score | course  | rank |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">85</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">  | English |    </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">00</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">  | Math    |    </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">row_number</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">partition</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> course </span><span style="color:#D73A49;">order by</span><span style="color:#24292E;"> score </span><span style="color:#D73A49;">DESC</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`rank\`</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> Scores;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#24292E;">| id | score | course  | rank |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">85</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">  | English |    </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">00</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">65</span><span style="color:#24292E;">  | Math    |    </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-------+---------+------+</span></span></code></pre></div><h2 id="偏移函数" tabindex="-1">偏移函数 <a class="header-anchor" href="#偏移函数" aria-label="Permalink to &quot;偏移函数&quot;">​</a></h2><p>LAG、LEAD可以在一定顺序下，获取当前行的前n行或后n行数据，作为新的列；</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">LAG</span><span style="color:#E1E4E8;">( [column1], [offset] ) </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> ( </span><span style="color:#F97583;">PARTITION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> [column2] </span><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> [column3] )</span></span>
<span class="line"><span style="color:#79B8FF;">LEAD</span><span style="color:#E1E4E8;">( [column1], [offset] ) </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> ( </span><span style="color:#F97583;">PARTITION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> [column2] </span><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> [column3] )</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">LAG</span><span style="color:#24292E;">( [column1], [offset] ) </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> ( </span><span style="color:#D73A49;">PARTITION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> [column2] </span><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> [column3] )</span></span>
<span class="line"><span style="color:#005CC5;">LEAD</span><span style="color:#24292E;">( [column1], [offset] ) </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> ( </span><span style="color:#D73A49;">PARTITION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> [column2] </span><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> [column3] )</span></span></code></pre></div><ul><li>column1：想要获取的列</li><li>offset：偏移量</li><li>column2：分组依据</li><li>column3：排序依据 如：想要查询按照id排序，连续相同的数字num有哪些？</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+</span></span>
<span class="line"><span style="color:#E1E4E8;">| id | num |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">7</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+</span></span>
<span class="line"><span style="color:#24292E;">| id | num |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">7</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+</span></span></code></pre></div><h3 id="lag" tabindex="-1">LAG <a class="header-anchor" href="#lag" aria-label="Permalink to &quot;LAG&quot;">​</a></h3><p>通过LAG扩展一列出来，查询当前行的前n行数据；</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">	id,</span></span>
<span class="line"><span style="color:#E1E4E8;">	num,                </span><span style="color:#6A737D;">-- 当前行的num</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">LAG</span><span style="color:#E1E4E8;">( num, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> ) </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> ( </span><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> id ) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> pre1, </span><span style="color:#6A737D;">-- 当前行的前1个num</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">LAG</span><span style="color:#E1E4E8;">( num, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> ) </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> ( </span><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> id ) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> pre2 </span><span style="color:#6A737D;">-- 当前行的前2个num</span></span>
<span class="line"><span style="color:#F97583;">FROM</span></span>
<span class="line"><span style="color:#E1E4E8;">	LOGS;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">| id | num | pre1 | pre2 |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+------+------+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> | </span><span style="color:#F97583;">NULL</span><span style="color:#E1E4E8;"> | </span><span style="color:#F97583;">NULL</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> | </span><span style="color:#F97583;">NULL</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">7</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |    </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+------+------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">	id,</span></span>
<span class="line"><span style="color:#24292E;">	num,                </span><span style="color:#6A737D;">-- 当前行的num</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">LAG</span><span style="color:#24292E;">( num, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> ) </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> ( </span><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> id ) </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> pre1, </span><span style="color:#6A737D;">-- 当前行的前1个num</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">LAG</span><span style="color:#24292E;">( num, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> ) </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> ( </span><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> id ) </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> pre2 </span><span style="color:#6A737D;">-- 当前行的前2个num</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span></span>
<span class="line"><span style="color:#24292E;">	LOGS;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+------+------+</span></span>
<span class="line"><span style="color:#24292E;">| id | num | pre1 | pre2 |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+------+------+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> | </span><span style="color:#D73A49;">NULL</span><span style="color:#24292E;"> | </span><span style="color:#D73A49;">NULL</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> | </span><span style="color:#D73A49;">NULL</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">7</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |    </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+------+------+</span></span></code></pre></div><h3 id="lead" tabindex="-1">LEAD <a class="header-anchor" href="#lead" aria-label="Permalink to &quot;LEAD&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">	Id,</span></span>
<span class="line"><span style="color:#E1E4E8;">	Num,                    </span><span style="color:#6A737D;">-- 当前行的num</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">LEAD</span><span style="color:#E1E4E8;">( Num, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> ) </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> ( </span><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> Id ) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> next1, </span><span style="color:#6A737D;">-- 当前行的后1个num</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">LEAD</span><span style="color:#E1E4E8;">( Num, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> ) </span><span style="color:#F97583;">over</span><span style="color:#E1E4E8;"> ( </span><span style="color:#F97583;">ORDER BY</span><span style="color:#E1E4E8;"> Id ) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> next2  </span><span style="color:#6A737D;">-- 当前行的后2个num</span></span>
<span class="line"><span style="color:#F97583;">FROM</span></span>
<span class="line"><span style="color:#E1E4E8;">	LOGS;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+-------+-------+</span></span>
<span class="line"><span style="color:#E1E4E8;">| Id | Num | next1 | next2 |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+-------+-------+</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> |     </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> | </span><span style="color:#F97583;">NULL</span><span style="color:#E1E4E8;">  |</span></span>
<span class="line"><span style="color:#E1E4E8;">|  </span><span style="color:#79B8FF;">7</span><span style="color:#E1E4E8;"> |   </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> | </span><span style="color:#F97583;">NULL</span><span style="color:#E1E4E8;">  | </span><span style="color:#F97583;">NULL</span><span style="color:#E1E4E8;">  |</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#6A737D;">----+-----+-------+-------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span></span>
<span class="line"><span style="color:#24292E;">	Id,</span></span>
<span class="line"><span style="color:#24292E;">	Num,                    </span><span style="color:#6A737D;">-- 当前行的num</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">LEAD</span><span style="color:#24292E;">( Num, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> ) </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> ( </span><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> Id ) </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> next1, </span><span style="color:#6A737D;">-- 当前行的后1个num</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">LEAD</span><span style="color:#24292E;">( Num, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> ) </span><span style="color:#D73A49;">over</span><span style="color:#24292E;"> ( </span><span style="color:#D73A49;">ORDER BY</span><span style="color:#24292E;"> Id ) </span><span style="color:#D73A49;">AS</span><span style="color:#24292E;"> next2  </span><span style="color:#6A737D;">-- 当前行的后2个num</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span></span>
<span class="line"><span style="color:#24292E;">	LOGS;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+-------+-------+</span></span>
<span class="line"><span style="color:#24292E;">| Id | Num | next1 | next2 |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+-------+-------+</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> |     </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> | </span><span style="color:#D73A49;">NULL</span><span style="color:#24292E;">  |</span></span>
<span class="line"><span style="color:#24292E;">|  </span><span style="color:#005CC5;">7</span><span style="color:#24292E;"> |   </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> | </span><span style="color:#D73A49;">NULL</span><span style="color:#24292E;">  | </span><span style="color:#D73A49;">NULL</span><span style="color:#24292E;">  |</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#6A737D;">----+-----+-------+-------+</span></span></code></pre></div>`,26),e=[o];function c(r,t,E,y,F,i){return n(),a("div",null,e)}const B=s(p,[["render",c]]);export{d as __pageData,B as default};
